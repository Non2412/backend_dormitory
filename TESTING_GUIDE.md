# ЁЯзк р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ API

## ЁЯУЛ р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ

р╕бр╕╡ 3 р╕зр╕┤р╕Шр╕╡р╣Гр╕Щр╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ API:

### р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 1: р╣Гр╕Кр╣Йр╣Др╕Яр╕ер╣М .http (р╣Бр╕Щр╕░р╕Щр╕│)
**р╣Ар╕лр╕бр╕▓р╕░р╕кр╕│р╕лр╕гр╕▒р╕Ъ**: р╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕Ър╕Ъ manual, debug р╣Бр╕Хр╣Ир╕ер╕░ endpoint

1. р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З **REST Client** extension р╣Гр╕Щ VS Code
2. р╣Ар╕Ыр╕┤р╕Фр╣Др╕Яр╕ер╣М `test-api-updated.http`
3. р╕Др╕ер╕┤р╕Б "Send Request" р╣Ар╕лр╕Щр╕╖р╕нр╣Бр╕Хр╣Ир╕ер╕░ request
4. р╕Фр╕╣р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Чр╕▓р╕Зр╕Вр╕зр╕▓р╕бр╕╖р╕н

**р╕Вр╣Йр╕нр╕Фр╕╡**:
- тЬЕ р╕Зр╣Ир╕▓р╕в р╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╕нр╕░р╣Др╕гр╣Ар╕Юр╕┤р╣Ир╕б
- тЬЕ р╣Ар╕лр╣Зр╕Щр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Чр╕▒р╕Щр╕Чр╕╡
- тЬЕ р╣Бр╕Бр╣Йр╣Др╕В request р╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕в
- тЬЕ р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Ыр╕гр╕░р╕зр╕▒р╕Хр╕┤ request

---

### р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 2: р╣Гр╕Кр╣Йр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
**р╣Ар╕лр╕бр╕▓р╕░р╕кр╕│р╕лр╕гр╕▒р╕Ъ**: р╕Чр╕Фр╕кр╕нр╕Ър╕Др╕гр╕Ър╕Чр╕╕р╕Б endpoint р╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Щ, CI/CD

1. р╣Ар╕Ыр╕┤р╕Ф terminal
2. р╕гр╕▒р╕Щ development server:
   ```bash
   npm run dev
   ```
3. р╣Ар╕Ыр╕┤р╕Ф terminal р╣Гр╕лр╕бр╣И р╣Бр╕ер╣Йр╕зр╕гр╕▒р╕Щ:
   ```bash
   node test-api-automated.js
   ```

**р╕Вр╣Йр╕нр╕Фр╕╡**:
- тЬЕ р╕Чр╕Фр╕кр╕нр╕Ър╕Чр╕╕р╕Бр╕нр╕вр╣Ир╕▓р╕Зр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
- тЬЕ р╣Бр╕кр╕Фр╕Зр╕кр╕Цр╕┤р╕Хр╕┤р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ
- тЬЕ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ edge cases
- тЬЕ р╣Ар╕лр╕бр╕▓р╕░р╕кр╕│р╕лр╕гр╕▒р╕Ъ regression testing

**р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Чр╕╡р╣Ир╕Др╕▓р╕Фр╕лр╕зр╕▒р╕З**:
```
ЁЯУК р╕кр╕гр╕╕р╕Ыр╕Ьр╕ер╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ
============================================================
тЬЕ р╕Ьр╣Ир╕▓р╕Щ: 35/35
тЭМ р╣Др╕бр╣Ир╕Ьр╣Ир╕▓р╕Щ: 0/35
ЁЯУИ р╕нр╕▒р╕Хр╕гр╕▓р╕Др╕зр╕▓р╕бр╕кр╕│р╣Ар╕гр╣Зр╕И: 100.00%
```

---

### р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 3: р╣Гр╕Кр╣Й Postman/Insomnia
**р╣Ар╕лр╕бр╕▓р╕░р╕кр╕│р╕лр╕гр╕▒р╕Ъ**: р╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕Ър╕Ър╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф, share р╕Бр╕▒р╕Ър╕Чр╕╡р╕б

1. Import р╣Др╕Яр╕ер╣М `test-api.http` р╕лр╕гр╕╖р╕н `test-api-updated.http`
2. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ environment variable: `baseUrl = http://localhost:3000/api`
3. р╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕Хр╣Ир╕ер╕░ request

---

## ЁЯОп р╕ер╕│р╕Фр╕▒р╕Ър╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ър╕Чр╕╡р╣Ир╣Бр╕Щр╕░р╕Щр╕│

### Phase 1: р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ
1. тЬЕ р╕кр╕гр╣Йр╕▓р╕З Users (Admin, Students)
2. тЬЕ р╕кр╕гр╣Йр╕▓р╕З Dormitories
3. тЬЕ р╕кр╕гр╣Йр╕▓р╕З Rooms

### Phase 2: р╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕лр╕ер╕▒р╕Б
4. тЬЕ р╕кр╕гр╣Йр╕▓р╕З Bookings (р╕Чр╕Фр╕кр╕нр╕Ъ transactions)
5. тЬЕ Update Bookings (р╕Чр╕Фр╕кр╕нр╕Ъ room status changes)
6. тЬЕ Cancel Bookings (р╕Чр╕Фр╕кр╕нр╕Ъ rollback)
7. тЬЕ р╕кр╕гр╣Йр╕▓р╕З Payments

### Phase 3: р╕Бр╕▓р╕гр╕Др╣Йр╕Щр╕лр╕▓р╣Бр╕ер╕░р╕Бр╕гр╕нр╕З
8. тЬЕ р╕Др╣Йр╕Щр╕лр╕▓ Users
9. тЬЕ Filter Rooms
10. тЬЕ р╕Фр╕╢р╕З Dashboard Stats

### Phase 4: Error Handling
11. тЬЕ р╕Чр╕Фр╕кр╕нр╕Ъ duplicate entries
12. тЬЕ р╕Чр╕Фр╕кр╕нр╕Ъ invalid data
13. тЬЕ р╕Чр╕Фр╕кр╕нр╕Ъ missing resources

---

## ЁЯУЭ Test Cases р╕кр╕│р╕Др╕▒р╕Н

### 1. Transaction Testing
**р╕зр╕▒р╕Хр╕Цр╕╕р╕Ыр╕гр╕░р╕кр╕Зр╕Др╣М**: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ booking р╣Бр╕ер╕░ room update р╣Ар╕Ыр╣Зр╕Щ atomic

```http
POST /api/bookings
{
  "userId": "...",
  "roomId": "...",
  "startDate": "2025-12-01",
  "totalAmount": 3000
}
```

**р╕Ьр╕ер╕Чр╕╡р╣Ир╕Др╕▓р╕Фр╕лр╕зр╕▒р╕З**:
- тЬЕ Booking р╕Цр╕╣р╕Бр╕кр╕гр╣Йр╕▓р╕З
- тЬЕ Room status р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Ар╕Ыр╣Зр╕Щ RESERVED
- тЬЕ р╕Цр╣Йр╕▓ booking р╕ер╣Йр╕бр╣Ар╕лр╕ер╕з room status р╣Др╕бр╣Ир╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ

---

### 2. JSON Parsing Testing
**р╕зр╕▒р╕Хр╕Цр╕╕р╕Ыр╕гр╕░р╕кр╕Зр╕Др╣М**: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ facilities р╣Бр╕Ыр╕ер╕Зр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З

```http
POST /api/dormitories
{
  "name": "р╕лр╕нр╕Юр╕▒р╕Бр╕Чр╕Фр╕кр╕нр╕Ъ",
  "facilities": ["WiFi", "р╕ер╕┤р╕Яр╕Хр╣М"]
}
```

**р╕Ьр╕ер╕Чр╕╡р╣Ир╕Др╕▓р╕Фр╕лр╕зр╕▒р╕З**:
- тЬЕ facilities р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Ар╕Ыр╣Зр╕Щ JSON string
- тЬЕ р╕Фр╕╢р╕Зр╕Бр╕ер╕▒р╕Ър╕бр╕▓р╣Ар╕Ыр╣Зр╕Щ Array
- тЬЕ р╣Др╕бр╣И crash р╕Цр╣Йр╕▓ JSON р╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф

---

### 3. Type Safety Testing
**р╕зр╕▒р╕Хр╕Цр╕╕р╕Ыр╕гр╕░р╕кр╕Зр╕Др╣М**: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Гр╕Кр╣Й Prisma types р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З

```http
GET /api/users?role=STUDENT&search=test
```

**р╕Ьр╕ер╕Чр╕╡р╣Ир╕Др╕▓р╕Фр╕лр╕зр╕▒р╕З**:
- тЬЕ р╣Др╕бр╣Ир╕бр╕╡ TypeScript errors
- тЬЕ Query р╕Чр╕│р╕Зр╕▓р╕Щр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
- тЬЕ р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Хр╕гр╕Зр╕Хр╕▓р╕бр╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕В

---

### 4. SQLite Compatibility Testing
**р╕зр╕▒р╕Хр╕Цр╕╕р╕Ыр╕гр╕░р╕кр╕Зр╕Др╣М**: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Бр╕▓р╕гр╕Др╣Йр╕Щр╕лр╕▓р╕Чр╕│р╕Зр╕▓р╕Щр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕бр╕╡ `mode: insensitive`

```http
GET /api/users?search=р╕кр╕б
```

**р╕Ьр╕ер╕Чр╕╡р╣Ир╕Др╕▓р╕Фр╕лр╕зр╕▒р╕З**:
- тЬЕ р╕Др╣Йр╕Щр╕лр╕▓р╣Др╕Фр╣Й (SQLite case-insensitive р╣Вр╕Фр╕в default)
- тЬЕ р╣Др╕бр╣Ир╕бр╕╡ error

---

### 5. Validation Testing
**р╕зр╕▒р╕Хр╕Цр╕╕р╕Ыр╕гр╕░р╕кр╕Зр╕Др╣М**: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ validation р╕Чр╕│р╕Зр╕▓р╕Щ

```http
POST /api/users
{
  "email": "invalid-email",
  "password": "123"
}
```

**р╕Ьр╕ер╕Чр╕╡р╣Ир╕Др╕▓р╕Фр╕лр╕зр╕▒р╕З**:
- тЬЕ Status 400
- тЬЕ Error message р╕Кр╕▒р╕Фр╣Ар╕Ир╕Щ

---

### 6. Dashboard Stats Testing
**р╕зр╕▒р╕Хр╕Цр╕╕р╕Ыр╕гр╕░р╕кр╕Зр╕Др╣М**: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ groupBy fix р╕Чр╕│р╕Зр╕▓р╕Щ

```http
GET /api/dashboard/stats?period=7
```

**р╕Ьр╕ер╕Чр╕╡р╣Ир╕Др╕▓р╕Фр╕лр╕зр╕▒р╕З**:
- тЬЕ р╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕Фр╣Й
- тЬЕ `bookingsPerDay` р╣Ар╕Ыр╣Зр╕Щ array
- тЬЕ р╣Бр╕Хр╣Ир╕ер╕░р╕зр╕▒р╕Щр╕бр╕╡ date р╣Бр╕ер╕░ count

---

## ЁЯФН р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М

### тЬЕ Success Response
```json
{
  "success": true,
  "data": {...},
  "message": "р╕кр╕│р╣Ар╕гр╣Зр╕И"
}
```

### тЭМ Error Response
```json
{
  "success": false,
  "error": "р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б error"
}
```

### ЁЯУД Paginated Response
```json
{
  "success": true,
  "data": [...],
  "pagination": {
    "page": 1,
    "limit": 10,
    "total": 50,
    "totalPages": 5
  }
}
```

---

## ЁЯРЫ Troubleshooting

### р╕Ыр╕▒р╕Нр╕лр╕▓: Connection refused
**р╕кр╕▓р╣Ар╕лр╕Хр╕╕**: Server р╣Др╕бр╣Ир╕Чр╕│р╕Зр╕▓р╕Щ

**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й**:
```bash
npm run dev
```

---

### р╕Ыр╕▒р╕Нр╕лр╕▓: Database locked
**р╕кр╕▓р╣Ар╕лр╕Хр╕╕**: SQLite р╕Цр╕╣р╕Бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Вр╕Фр╕в process р╕нр╕╖р╣Ир╕Щ

**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й**:
1. р╕Ыр╕┤р╕Ф server
2. р╕ер╕Ър╣Др╕Яр╕ер╣М `dev.db-journal` (р╕Цр╣Йр╕▓р╕бр╕╡)
3. р╣Ар╕Ыр╕┤р╕Ф server р╣Гр╕лр╕бр╣И

---

### р╕Ыр╕▒р╕Нр╕лр╕▓: Prisma Client not found
**р╕кр╕▓р╣Ар╕лр╕Хр╕╕**: р╕вр╕▒р╕Зр╣Др╕бр╣И generate Prisma Client

**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й**:
```bash
npx prisma generate
```

---

### р╕Ыр╕▒р╕Нр╕лр╕▓: TypeScript errors
**р╕кр╕▓р╣Ар╕лр╕Хр╕╕**: Type definitions р╣Др╕бр╣Ир╕Хр╕гр╕Зр╕Бр╕▒р╕Щ

**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й**:
```bash
npm install
npx prisma generate
```

---

## ЁЯУК Metrics р╕Чр╕╡р╣Ир╕Др╕зр╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ

### Performance
- тП▒я╕П Response time < 200ms (local)
- тП▒я╕П Transaction time < 500ms

### Reliability
- тЬЕ Success rate > 99%
- тЬЕ No crashes on invalid input
- тЬЕ Proper error messages

### Data Integrity
- тЬЕ Transactions are atomic
- тЬЕ Foreign keys are valid
- тЬЕ No orphaned records

---

## ЁЯОУ Best Practices

### 1. р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╣Ир╕нр╕Щ Deploy
```bash
# р╕гр╕▒р╕Щ automated tests
node test-api-automated.js

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Ьр╣Ир╕▓р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
# р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕Ьр╣Ир╕▓р╕Щ р╕нр╕вр╣Ир╕▓ deploy
```

### 2. р╕Чр╕Фр╕кр╕нр╕Ъ Edge Cases
- р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕зр╣Ир╕▓р╕З
- р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕вр╕▓р╕зр╕бр╕▓р╕Б
- р╕Хр╕▒р╕зр╕нр╕▒р╕Бр╕йр╕гр╕Юр╕┤р╣Ар╕ир╕й
- Unicode characters

### 3. р╕Чр╕Фр╕кр╕нр╕Ъ Concurrent Requests
```bash
# р╣Гр╕Кр╣Й tool р╣Ар╕Кр╣Ир╕Щ Apache Bench
ab -n 100 -c 10 http://localhost:3000/api/users
```

### 4. р╕Чр╕Фр╕кр╕нр╕Ъ Database Cleanup
```bash
# р╕ер╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕Фр╕кр╕нр╕Ър╕лр╕ер╕▒р╕Зр╣Ар╕кр╕гр╣Зр╕И
# р╕лр╕гр╕╖р╕нр╣Гр╕Кр╣Й test database р╣Бр╕вр╕Б
```

---

## ЁЯУЪ р╣Ар╕нр╕Бр╕кр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б

- [API_DOCS.md](./API_DOCS.md) - API Documentation
- [FIXES_CHANGELOG.md](./FIXES_CHANGELOG.md) - р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В
- [README.md](./README.md) - Project Overview

---

## тЬи р╕кр╕гр╕╕р╕Ы

р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ър╕Чр╕╡р╣Ир╕Фр╕╡р╕Др╕зр╕гр╕Др╕гр╕нр╕Ър╕Др╕ер╕╕р╕б:
1. тЬЕ **Happy Path** - р╕Бр╕гр╕Ур╕╡р╕Ыр╕Бр╕Хр╕┤
2. тЬЕ **Error Cases** - р╕Бр╕гр╕Ур╕╡р╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф
3. тЬЕ **Edge Cases** - р╕Бр╕гр╕Ур╕╡р╕Юр╕┤р╣Ар╕ир╕й
4. тЬЕ **Performance** - р╕Др╕зр╕▓р╕бр╣Ар╕гр╣Зр╕з
5. тЬЕ **Security** - р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в
6. тЬЕ **Data Integrity** - р╕Др╕зр╕▓р╕бр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕Вр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е

**Happy Testing! ЁЯОЙ**
